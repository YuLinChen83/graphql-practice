# Migration `20200806010854-v1`

This migration has been generated by Tiffany at 8/6/2020, 1:08:54 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `singple`.`User` (
`id` int NOT NULL  AUTO_INCREMENT,
`email` varchar(191) NOT NULL ,
`lastName` varchar(191) NOT NULL ,
`firstName` varchar(191) NOT NULL ,
`nickName` varchar(191) NOT NULL ,
`website` varchar(191)  ,
`notified` boolean NOT NULL DEFAULT false,
`activated` boolean NOT NULL DEFAULT false,
`birthday` datetime(3)  ,
`photo` varchar(191)  ,
`gender` ENUM('MALE', 'FEMALE', 'TRANSGENDER')  ,
`role` ENUM('SUPERADMIN', 'ADMIN', 'TEACHER', 'USER') NOT NULL DEFAULT 'USER',
`password` varchar(191) NOT NULL ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime(3)  ,
`facebookId` varchar(191)  ,
`googleId` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `singple`.`Course` (
`id` int NOT NULL  AUTO_INCREMENT,
`title` varchar(191) NOT NULL ,
`content` varchar(191) NOT NULL ,
`price` int NOT NULL ,
`specialPrice` int  ,
`vedioUrl` varchar(191)  ,
`remark` varchar(191)  ,
`publishTime` datetime(3)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `singple`.`SystematicCourse` (
`chapter` int NOT NULL ,
`unit` int NOT NULL ,
`title` varchar(191) NOT NULL ,
`content` varchar(191) NOT NULL ,
`vedioUrl` varchar(191)  ,
`remark` varchar(191)  ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime(3)  ,
`courseId` int NOT NULL ,
PRIMARY KEY (`courseId`,`unit`,`chapter`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `singple`.`OneToOneCourseReservation` (
`id` int NOT NULL  AUTO_INCREMENT,
`courseId` int NOT NULL ,
`userId` int NOT NULL ,
`startTime` datetime(3)  ,
`endTime` datetime(3)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `singple`.`CourseComment` (
`id` int NOT NULL  AUTO_INCREMENT,
`courseId` int NOT NULL ,
`userId` int NOT NULL ,
`content` varchar(191) NOT NULL ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime(3)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `singple`.`CourseCommentReply` (
`id` int NOT NULL ,
`userId` int NOT NULL ,
`content` varchar(191) NOT NULL ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime(3)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.email` ON `singple`.`User`(`email`)

ALTER TABLE `singple`.`SystematicCourse` ADD FOREIGN KEY (`courseId`) REFERENCES `singple`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`OneToOneCourseReservation` ADD FOREIGN KEY (`courseId`) REFERENCES `singple`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`OneToOneCourseReservation` ADD FOREIGN KEY (`userId`) REFERENCES `singple`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`CourseComment` ADD FOREIGN KEY (`courseId`) REFERENCES `singple`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`CourseComment` ADD FOREIGN KEY (`userId`) REFERENCES `singple`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`CourseCommentReply` ADD FOREIGN KEY (`id`) REFERENCES `singple`.`CourseComment`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `singple`.`CourseCommentReply` ADD FOREIGN KEY (`userId`) REFERENCES `singple`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200806010854-v1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,98 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource mysql {
+  provider = "mysql"
+  url = "***"
+}
+
+model User {
+  id             Int              @default(autoincrement()) @id
+  email          String           @unique
+  lastName       String
+  firstName       String
+  nickName       String
+  website        String?
+  notified        Boolean          @default(false)
+  activated      Boolean          @default(false)
+  birthday       DateTime?
+  photo          String?
+  gender         Gender?
+  role           Role             @default(USER)
+  password       String
+  createdAt      DateTime         @default(now())
+  updatedAt      DateTime?        @updatedAt
+  facebookId     String?
+  googleId       String?
+}
+
+model Course {
+  id             Int              @default(autoincrement()) @id
+  title          String
+  content        String
+  price          Int
+  specialPrice   Int?
+  vedioUrl       String?
+  remark         String?
+  publishTime    DateTime?
+}
+
+model SystematicCourse {
+  chapter        Int
+  unit           Int
+  title          String
+  content        String
+  vedioUrl       String?
+  remark         String?
+  createdAt      DateTime         @default(now())
+  updatedAt      DateTime?        @updatedAt
+  courseId       Int
+  course         Course           @relation(fields: [courseId], references: [id])
+
+  @@id([courseId, unit, chapter])
+}
+
+model OneToOneCourseReservation {
+  id             Int              @default(autoincrement()) @id
+  courseId       Int
+  course         Course           @relation(fields: [courseId], references: [id])
+  userId         Int
+  user           User             @relation(fields: [userId], references: [id])
+  startTime      DateTime?
+  endTime        DateTime?
+}
+
+model CourseComment {
+  id             Int              @default(autoincrement()) @id
+  courseId       Int
+  course         Course           @relation(fields: [courseId], references: [id])
+  userId         Int
+  author         User             @relation(fields: [userId], references: [id])
+  content        String
+  createdAt      DateTime         @default(now())
+  updatedAt      DateTime?        @updatedAt
+}
+
+model CourseCommentReply {
+  id             Int              @default(autoincrement()) @id
+  commentId      CourseComment    @relation(fields: [id], references: [id])
+  userId         Int
+  author         User             @relation(fields: [userId], references: [id])
+  content        String
+  createdAt      DateTime         @default(now())
+  updatedAt      DateTime?        @updatedAt
+}
+
+enum Gender {
+  MALE
+  FEMALE
+  TRANSGENDER
+}
+
+enum Role {
+  SUPERADMIN
+  ADMIN
+  TEACHER
+  USER
+}
```


